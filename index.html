<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>暗黑破坏神2 - 角色加点模拟器</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- 粒子背景 -->
  <div id="particles"></div>
  
  <!-- 主容器 -->
  <div id="app">
    <!-- 角色选择界面 -->
    <div id="class-select-screen" class="screen active">
      <div class="title-banner">
        <div class="title-ornament"></div>
        <h1 class="game-title">暗黑破坏神 II</h1>
        <h2 class="subtitle">角色属性 · 技能模拟器</h2>
        <div class="title-ornament"></div>
      </div>
      <div class="class-grid" id="classGrid"></div>
      <div class="version-note">数据基于 D2R v2.8 / D2 LoD 1.14d</div>
    </div>

    <!-- 主游戏界面 -->
    <div id="main-screen" class="screen">
      <header class="top-bar">
        <button class="btn-back" id="btnBack" title="返回选择角色">
          <span class="back-icon">◀</span> 选择角色
        </button>
        <div class="char-header">
          <span class="char-class-icon" id="headerIcon"></span>
          <div class="char-title-info">
            <h2 class="char-class-name" id="headerClassName"></h2>
            <span class="char-level-display">等级 <span id="headerLevel">1</span></span>
          </div>
        </div>
        <div class="header-points">
          <div class="point-badge attr" title="剩余属性点">
            <span class="badge-label">属性点</span>
            <span class="badge-value" id="headerAttrPoints">0</span>
          </div>
          <div class="point-badge skill" title="剩余技能点">
            <span class="badge-label">技能点</span>
            <span class="badge-value" id="headerSkillPoints">0</span>
          </div>
        </div>
        <button class="btn-reset" id="btnReset" title="重置所有加点">↺ 重置</button>
      </header>

      <div class="main-content">
        <!-- 左侧：属性面板 -->
        <aside class="stats-panel">
          <div class="panel-header">角色属性</div>

          <div class="level-section">
            <label class="stat-label">角色等级</label>
            <div class="level-control">
              <button class="level-btn" id="lvlDown">−</button>
              <input type="number" id="charLevel" class="level-input" value="1" min="1" max="99">
              <button class="level-btn" id="lvlUp">+</button>
            </div>
          </div>

          <div class="divider"></div>

          <div class="attr-section">
            <div class="points-available">
              <span>可用属性点</span>
              <span class="points-num" id="attrPointsDisplay">0</span>
            </div>

            <div class="attr-row" data-attr="str">
              <div class="attr-info">
                <span class="attr-name">力量</span>
                <span class="attr-desc">提升武器伤害和装备要求</span>
              </div>
              <div class="attr-controls">
                <button class="attr-btn minus" data-attr="str">−</button>
                <span class="attr-value" id="strValue">0</span>
                <button class="attr-btn plus" data-attr="str">+</button>
              </div>
            </div>
            <div class="attr-bar-row">
              <div class="attr-bar-bg">
                <div class="attr-bar-fill str-bar" id="strBar"></div>
              </div>
            </div>

            <div class="attr-row" data-attr="dex">
              <div class="attr-info">
                <span class="attr-name">敏捷</span>
                <span class="attr-desc">提升攻击评级和格挡</span>
              </div>
              <div class="attr-controls">
                <button class="attr-btn minus" data-attr="dex">−</button>
                <span class="attr-value" id="dexValue">0</span>
                <button class="attr-btn plus" data-attr="dex">+</button>
              </div>
            </div>
            <div class="attr-bar-row">
              <div class="attr-bar-bg">
                <div class="attr-bar-fill dex-bar" id="dexBar"></div>
              </div>
            </div>

            <div class="attr-row" data-attr="vit">
              <div class="attr-info">
                <span class="attr-name">体力</span>
                <span class="attr-desc">提升生命值和耐力</span>
              </div>
              <div class="attr-controls">
                <button class="attr-btn minus" data-attr="vit">−</button>
                <span class="attr-value" id="vitValue">0</span>
                <button class="attr-btn plus" data-attr="vit">+</button>
              </div>
            </div>
            <div class="attr-bar-row">
              <div class="attr-bar-bg">
                <div class="attr-bar-fill vit-bar" id="vitBar"></div>
              </div>
            </div>

            <div class="attr-row" data-attr="ene">
              <div class="attr-info">
                <span class="attr-name">能量</span>
                <span class="attr-desc">提升法力值上限</span>
              </div>
              <div class="attr-controls">
                <button class="attr-btn minus" data-attr="ene">−</button>
                <span class="attr-value" id="eneValue">0</span>
                <button class="attr-btn plus" data-attr="ene">+</button>
              </div>
            </div>
            <div class="attr-bar-row">
              <div class="attr-bar-bg">
                <div class="attr-bar-fill ene-bar" id="eneBar"></div>
              </div>
            </div>
          </div>

          <div class="divider"></div>

          <div class="derived-stats">
            <div class="panel-header sub">计算属性</div>
            <div class="derived-grid">
              <div class="derived-item life">
                <div class="derived-icon">❤️</div>
                <div class="derived-info">
                  <span class="derived-label">生命值</span>
                  <span class="derived-value" id="lifeValue">0</span>
                </div>
              </div>
              <div class="derived-item mana">
                <div class="derived-icon">🔵</div>
                <div class="derived-info">
                  <span class="derived-label">法力值</span>
                  <span class="derived-value" id="manaValue">0</span>
                </div>
              </div>
              <div class="derived-item stamina">
                <div class="derived-icon">🟢</div>
                <div class="derived-info">
                  <span class="derived-label">耐力</span>
                  <span class="derived-value" id="staminaValue">0</span>
                </div>
              </div>
              <div class="derived-item defense">
                <div class="derived-icon">🛡️</div>
                <div class="derived-info">
                  <span class="derived-label">基础防御</span>
                  <span class="derived-value" id="defenseValue">0</span>
                </div>
              </div>
            </div>
            <div class="stat-formula-note">
              <div class="formula-row">
                <span>每点体力</span>
                <span id="formulaVitLife">+? 生命 / +? 耐力</span>
              </div>
              <div class="formula-row">
                <span>每点能量</span>
                <span id="formulaEneMana">+? 法力</span>
              </div>
              <div class="formula-row">
                <span>每点力量</span>
                <span>+1% 武器伤害</span>
              </div>
            </div>
          </div>

          <div class="divider"></div>

          <div class="skill-points-section">
            <div class="panel-header sub">技能点</div>
            <div class="skill-points-info">
              <div class="sp-row">
                <span>可用技能点</span>
                <span class="points-num" id="skillPointsDisplay">0</span>
              </div>
              <div class="sp-row total">
                <span>已使用</span>
                <span id="usedSkillPoints">0</span>
              </div>
            </div>
          </div>
        </aside>

        <!-- 右侧：技能树 -->
        <main class="skill-panel">
          <div class="skill-panel-header">
            <div class="tree-tabs" id="treeTabs"></div>
            <div class="skill-pts-badge">
              技能点 <span id="skillPtsRemain">0</span>
            </div>
          </div>
          <div class="skill-tree-container" id="skillTreeContainer"></div>
        </main>
      </div>
    </div>
  </div>

  <!-- 技能详情弹窗 -->
  <div id="skillModal" class="modal-overlay" style="display:none">
    <div class="modal-box">
      <button class="modal-close" id="modalClose">✕</button>
      <div class="modal-header">
        <div class="modal-skill-name" id="modalSkillName"></div>
        <div class="modal-class-badge" id="modalClassBadge"></div>
      </div>
      <div class="modal-desc" id="modalDesc"></div>
      <div class="modal-level-control">
        <button class="modal-lv-btn" id="modalLvMinus">−</button>
        <div class="modal-lv-display">
          <span class="modal-lv-label">技能等级</span>
          <span class="modal-lv-num" id="modalLvNum">0</span>
          <span class="modal-lv-max">/ 20</span>
        </div>
        <button class="modal-lv-btn" id="modalLvPlus">+</button>
      </div>
      <div class="modal-effects" id="modalEffects"></div>
      <div class="modal-prereq" id="modalPrereq"></div>
      <div class="modal-actions">
        <button class="btn-skill-add" id="modalAddPoint">+1 技能点</button>
        <button class="btn-skill-remove" id="modalRemovePoint">−1 技能点</button>
      </div>
    </div>
  </div>

  <script src="data.js"></script>
  <script src="app.js"></script>
</body>
</html>
